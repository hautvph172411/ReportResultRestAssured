package api.test;import api.endpoint.EndpointForm;import api.endpoint.RouterBookingCare;import api.ultis.ApiDistrictInfor;import api.ultis.DataUltils;import api.ultis.SlackNotificationUltis;import com.google.gson.JsonArray;import com.google.gson.JsonElement;import com.google.gson.JsonObject;import com.google.gson.JsonParser;import io.restassured.response.Response;import org.testng.annotations.Test;import java.util.Iterator;import static io.restassured.RestAssured.baseURI;public class LocationDistrictTest {    private static int countNumberQuanHuyen(JsonArray array, String key) {        int count = 0;        Iterator check = array.iterator();        while (check.hasNext()) {            JsonElement element = (JsonElement) check.next();            JsonObject object = element.getAsJsonObject();            if (object.has(key)) {                ++count;            }        }        return count;    }    @Test(description = "API Quận Huyện: Kiểm tra dữ liệu trả về đầy đủ với mã tỉnh thành = 1")    private static void checkDataAPIQuanHuyen() {        String ma = "1";        Response response = EndpointForm.listQuanHuyen(ma);        JsonObject jsonObject = JsonParser.parseString(response.asString()).getAsJsonObject();        JsonArray dulieuArray = jsonObject.getAsJsonArray("dulieu");        int count = countNumberQuanHuyen(dulieuArray, "ma");        if (count != 30) {            SlackNotificationUltis.sendSlackNotification("APIQuanHuyen matinhthanh = 1 tra ve không đúng mong muốn = 30 quan/huyen");        }    }    @Test(description = "API Quận Huyện: Kiểm tra dữ liệu trả về với mã random")    private static void checkDataAPIQuanHuyenRandomData() {        String ma = DataUltils.getIdTinhThanh();        Response response = EndpointForm.listQuanHuyen(ma);        JsonObject jsonObject = JsonParser.parseString(response.asString()).getAsJsonObject();        JsonArray dulieuArray = jsonObject.getAsJsonArray("dulieu");        if (dulieuArray.isEmpty()) {            SlackNotificationUltis.sendSlackNotification("ApiQuanHuyen khong co data tra ve voi ID= " + ma);        }    }    @Test(description = "API Quận Huyện: Kiểm tra dữ liệu không có Quận Cầu Giấy  với mã tỉnh thành =1")    private static void checkDataExpectedWithIdProvince() {        baseURI = RouterBookingCare.BASE_URL;        String endpoint = RouterBookingCare.ENDPOINT_QUANHUYEN_URL;        String maTinhThanh = "1";        ApiDistrictInfor adressInfor = new ApiDistrictInfor(baseURI, maTinhThanh, endpoint);        String ten = adressInfor.getDuLieuMa("Quận Cầu Giấy");        if (!"5".equals(ten)) {            SlackNotificationUltis.sendSlackNotification("ERROR MaQuanHuyen khong tra ve = 21");        }    }}